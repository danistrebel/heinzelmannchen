define(["jquery","underscorejs"],function(e,n){function r(e){return"https://api.github.com/repos/"+e.org+"/"+e.name+"/issues?per_page=100"}function t(n,r,t){var o=r+(t?"&page="+t:"");return e.ajax({url:o,type:"GET",cache:!1,beforeSend:function(e){e.setRequestHeader("Authorization","token "+n.authToken)},success:function(e,n,t){var o=t.getResponseHeader("link");o&&o.indexOf('rel="next"')>0?(a[r]||(a[r]=1),a[r]=a[r]+1):a[r]&&delete a[r]}})}function o(e,n){var o=_.map(e.repos,function(n){return t(e,r(n))});u(e,o,[],n)}function u(e,n,r,o){Promise.all(n).then(function(){var n=_.union(r,_.flatten(arguments));if(0===_.keys(a).length)o(n);else{var s=_.map(_.pairs(a),function(n){return t(e,n[0],n[1])});u(e,s,n,o)}},function(e){console.error(e)})}var a={};return{loadIssues:o}});